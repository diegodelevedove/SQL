----------- Criando Tabelas /PL SQL by Abuthol -----------------

CREATE TABLE TB_PROJETO(

	CD_PROJETO NUMBER(4),
	NM_PROJETO VARCHAR2(20),
	DT_INICIO DATE,
	DT_FIM DATE
)

CREATE TABLE TB_TAREFA (

	CD_TAREFA NUMBER(5),
	NM_TAREFA VARCHAR2 (100) NOT NULL,
	DT_INICIO DATE,
	DT_FIM DATE,
	CD_PROJETO NUMBER(4)

)

ALTER TABLE TB_PROJETO ADD(CONSTRAINT PROJETO_PK  PRIMARY KEY(CD_PROJETO);
-- Também posso definir na modelagem
-- Posso definir uma nova chave sem ter definido uma anterior na modelagem (essa prática vai criar uma
chave composta)

-- CRIANDO UMA VALIDAÇÃO PRA DATA

ALTER TABLE TB_PROJETO
ADD (CONSTRAINT PROJETO_PK CHECK(DT_INICIO > DT_FINAL); --Check(Condiçao) depois podemos separar as checks

-- ADCIONANDO UM NOVO ATRIBUTO E VALIDANDO

ALTER TABLE TB_PROJETO
ADD(IE_ATIVO CHAR(1) DEFAULT 'A' CONSTRAINT ATIVO_CK CHECK(IE_ATIVO IN ('A','I)));

ALTER TABLE TB_TAREFA
ADD(CONSTRAINT TAREFA_PK PRIMARY KEY (CD_TAREFA),CONSTRAINT TAREFA_FK FOREIGN KEY (CD_PROJETO) REFERENCES TB_PROJETOS(CD_PROJETOS));

ALTER TABLE TB_PROJETO
MODIFY(NM_PROJETO VARCHAR2(50) CONSTRAINT PROJETO_NM NOT NULL);		

-- DAR CARGA

INSERT INTO TB_PROJETO(CD_PROJETO,NM_PROJETO,DT_INICIO,DT_FINAL)
VALUES(1,'CONTROLE DE VENDAS', TO_DATE('08/06/2018','DD/MM/YYYY'),TO_DATE('09/06/2018', 'DD/MM/YYYY')); -- TO DATA() FORÇA A CONVERSÃO DA DATA


-- SELECT * FROM TB_PROJETO;

-------- CRIANDO UM AUTO INCREMENTE ----------- 



CREATE SEQUENCE SEQ_CD_TAREFA
MINVALUE 1
MAXVALUE 9999999999
START WITH 1
INCREMENT BY 1

INSERT INTO TB_TAREFA (SEQ_CD_TAREFA.NEXTVAL,'COMISSÃO DE VENDAS',TO_DATE('08/06/2018','DD/MM/YYYY'),TO_DATE('09/06/2018','DD/MM/YYYY'),1);
-- NEXTVAL DIZ AO MINVALUE PARA INTERAR, LEMBRE-SE QUE É UMA FUNÇÃO


SELECT * FROM TB_TAREFA;


UPDADE TB_PROJETO
SET NM_PROJETO = 'COMPRAS'
WHERE CD_PROJETO = 5;

SELECT * FROM TB_PROJETO WHERE NM_PROJETO = 5;


